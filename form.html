<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Attendance Form</title>
  <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;500;600&display=swap" rel="stylesheet"/>
  <style>
    /* (Same styles as before, unchanged for brevity) */
    /* Add any specific style adjustments below if needed */
  </style>
</head>
<body>
  <header>
    <div class="logo-container">
      <img src="logo-512x512-1.png" alt="DAV Logo" />
    </div>
    <h1>D.A.V. College Jalandhar</h1>
  </header>

  <main>
    <div class="form-container">
      <h2>Attendance Form</h2>
      <form id="attendanceForm">
        <label for="code">Security Code</label>
        <input type="text" id="code" maxlength="3" required />

        <label for="roll">Roll Number</label>
        <select id="roll" required>
          <option value="">-- Select Roll Number --</option>
        </select>

        <label for="name">Name</label>
        <input type="text" id="name" readonly />

        <label>
          <input type="checkbox" id="confirm" /> I confirm that I am present
        </label>

        <button type="submit" disabled>Submit</button>
        <p id="status" style="margin-top:1rem; color: #f44336;"></p>
      </form>
    </div>
  </main>

  <footer>
    <!-- Footer unchanged -->
  </footer>

  <script>
    const students = {
      "01": "CHIRAG RANA",
      "02": "SHARANJIT SINGH",
      "03": "ANEESH KUMAR",
      "04": "JATINVEER",
      "05": "SOHAN KUMAR",
      "06": "TUSHAR",
      "07": "VANSH SHARMA",
      "08": "SAGAR KUMAR MANDAL",
      "09": "MEHAK",
      "10": "MANREET KAUR",
      "11": "ARUSHI",
      "12": "MANNAT",
      "13": "SURAJ SINGH",
      "14": "DIPANKAR",
      "15": "SNEHA",
      "16": "NAVJOT KAUR",
      "17": "ADITYA SHARMA",
      "18": "ROHAN",
      "19": "DAMANJEET",
      "20": "SHIVAM PANDEY",
      "21": "NITIN",
      "22": "NIKHIL",
      "23": "AARUSHI MALHOTRA",
      "24": "ANKIT KUMAR",
      "25": "EKAMJEET KAUR KALRA",
      "26": "SHIVAM",
      "27": "PRABHSIMRANJOT SINGH",
      "28": "SUMANT SHARMA",
      "29": "HARSHIT",
      "30": "NAMPREET SINGH",
      "31": "TANUSH",
      "32": "PARTH AULUCK",
      "33": "TANISH JAIN",
      "34": "PALAK BHARDWAJ",
      "35": "AKASH DEEP",
      "36": "AYUSH KUMAR",
      "37": "LAKSH",
      "38": "JASHAN ARORA",
      "39": "KRISHAN SINGH",
      "40": "KULWINDER KAUR",
      "41": "DAKSH CHAUHAN",
      "42": "DIWAKAR",
      "43": "SARUCHI SHARMA",
      "44": "AMRITPAL SINGH",
      "45": "GLORY",
      "46": "SIMRAN",
      "47": "MANIK",
      "48": "OM TALWAR",
      "49": "NITIN KUMARN BASRA",
      "50": "KHUSHI",
      "51": "KUNAL BHAGAT",
      "52": "JATIN GILHOTRA",
      "53": "LAKSH KALIA",
      "54": "LAKSHAY JOSHI",
      "55": "MAANSHU DUBEY",
      "56": "PREET LOI",
      "57": "KARAN SINGH",
      "58": "VIBHOR JAIN",
      "59": "UTKARSHA RAJ SINGH",
      "60": "MEHAK",
      "61": "NIKHIL"
    };

    const form = document.getElementById("attendanceForm");
    const codeInput = document.getElementById("code");
    const rollInput = document.getElementById("roll");
    const nameInput = document.getElementById("name");
    const checkbox = document.getElementById("confirm");
    const submitBtn = form.querySelector("button");
    const status = document.getElementById("status");

    // Populate dropdown
    for (const roll in students) {
      const option = document.createElement("option");
      option.value = roll;
      option.textContent = roll;
      rollInput.appendChild(option);
    }

    function getTodayCode() {
      const today = new Date();
      const code = (today.getDate() * 7 + (today.getMonth() + 1)) % 1000;
      return code.toString().padStart(3, '0');
    }

    function isWithinTimeWindow() {
      const now = new Date();
      const start = new Date(now);
      const end = new Date(now);
      start.setHours(13, 30, 0);
      end.setHours(14, 15, 0);
      return now >= start && now <= end;
    }

    function validateForm() {
      const roll = rollInput.value;
      const code = codeInput.value.trim();
      const correctCode = getTodayCode();

      nameInput.value = students[roll] || "";

      const valid = isWithinTimeWindow() && checkbox.checked && code === correctCode && students.hasOwnProperty(roll);
      submitBtn.disabled = !valid;

      if (!isWithinTimeWindow()) {
        status.textContent = "Attendance is only open from 1:30 PM to 2:15 PM IST.";
      } else if (code !== correctCode) {
        status.textContent = "Invalid security code.";
      } else if (!students.hasOwnProperty(roll)) {
        status.textContent = "Invalid roll number.";
      } else if (!checkbox.checked) {
        status.textContent = "Please confirm your presence.";
      } else {
        status.textContent = "";
      }
    }

    codeInput.addEventListener("input", validateForm);
    rollInput.addEventListener("change", validateForm);
    checkbox.addEventListener("change", validateForm);

    form.addEventListener("submit", function (e) {
      e.preventDefault();
      alert("Attendance submitted for: " + rollInput.value);
    });
  </script>
</body>
</html>
