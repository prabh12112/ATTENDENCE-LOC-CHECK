<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Attendance Form</title>
  <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;500;600&display=swap" rel="stylesheet">
  <style>
    * { margin: 0; padding: 0; box-sizing: border-box; font-family: 'Montserrat', sans-serif; }
    body { background-color: #121212; color: #ffffff; overflow-x: hidden; }
    #preloader { position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: #121212; display: flex; align-items: center; justify-content: center; z-index: 9999; transition: all 0.5s ease; }
    #preloader.fade-out { opacity: 0; transform: scale(0); pointer-events: none; }
    .spinner { border: 4px solid #ccc; border-top: 4px solid rgba(30, 144, 255, 0.5); border-radius: 50%; width: 40px; height: 40px; animation: spin 1s linear infinite; }
    @keyframes spin { 0% { transform: rotate(0); } 100% { transform: rotate(360deg); } }
    header { display: flex; align-items: center; gap: 1rem; padding: 0.6rem 1.5rem; background-color: #1a1a1a; }
    .logo-container { background: white; border-radius: 8px; padding: 4px; }
    .logo-container img { height: 40px; width: auto; }
    h1 { font-size: 1.2rem; }
    main { position: relative; z-index: 1; padding: 2rem; text-align: center; min-height: 100vh; display: flex; flex-direction: column; align-items: center; justify-content: center; opacity: 0; transform: translateX(-20px); transition: opacity 1s ease, transform 1s ease; }
    main.visible { opacity: 1; transform: translateX(0); }
    main::before { content: ""; background-image: url('python-blog-image.jpg'); background-size: cover; background-position: center; position: absolute; inset: 0; z-index: -2; opacity: 0.25; filter: brightness(0.6); }
    main::after { content: ""; position: absolute; inset: 0; background: radial-gradient(ellipse at center, rgba(0,0,0,0) 40%, rgba(0,0,0,0.9) 100%); z-index: -1; }
    form { background-color: rgba(0,0,0,0.6); padding: 2rem; border-radius: 12px; max-width: 600px; width: 100%; margin: 2rem auto; box-shadow: 0 0 20px rgba(0,0,0,0.4); text-align: left; }
    label { display: block; margin: 1rem 0 0.5rem; }
    select, input[type="text"], input[type="checkbox"] { width: 100%; padding: 0.7rem; border-radius: 8px; border: none; background-color: #222; color: white; }
    input[readonly] { background-color: #333; }
    button { margin-top: 1rem; width: 100%; padding: 0.8rem; border: none; border-radius: 8px; background-color: #4fc3f7; color: #000; font-weight: bold; cursor: pointer; }
    button:hover { background-color: #03a9f4; }
    .hidden { display: none; }
    .error { color: red; font-size: 0.9rem; }
    footer { background-color: #1a1a1a; color: white; padding: 2rem; text-align: center; }
    .footer-content { display: grid; grid-template-columns: repeat(auto-fit, minmax(160px, 1fr)); gap: 1.5rem; margin-bottom: 1rem; text-align: left; }
    .footer-section h4 { font-size: 0.9rem; margin-bottom: 0.5rem; }
    .footer-section ul { list-style: none; padding: 0; font-size: 0.8rem; }
    .footer-section li { margin-bottom: 4px; }
    .footer-section a { color: #ccc; text-decoration: none; font-size: 0.8rem; }
    .footer-divider { height: 1px; background: #444; margin: 1rem 0; opacity: 0.4; }
    .footer-bottom { font-size: 0.75rem; text-align: center; margin-top: 1rem; }
  </style>
</head>
<body oncontextmenu="return false">
<div id="preloader"><div class="spinner"></div></div>

<header>
  <div class="logo-container"><img src="logo-512x512-1.png" alt="DAV Logo"></div>
  <h1>D.A.V. College Jalandhar</h1>
</header>

<main id="main-content">
  <form id="attendanceForm" method="POST" action="https://script.google.com/macros/s/AKfycbxSVOE1_zV-N_fFAi6U1i-cRD6zObrb_1MlFsbNkJd-ps8xCzq7-OcNZBPJKaymNk-rNg/exec" target="hidden_iframe">
    <h2>Attendance Form</h2>
    <label for="code">Security Code</label>
    <input type="text" id="code" maxlength="3" required>
    <div id="codeError" class="error hidden">Invalid code. Please try again.</div>

    <label for="roll">Roll Number</label>
    <select id="roll" name="roll" required><option value="">Select Roll Number</option></select>

    <label for="name">Name</label>
    <input type="text" id="name" name="name" readonly required>

    <label><input type="checkbox" id="confirm" required> I confirm that I am present.</label>
    <button type="submit">Submit Attendance</button>
  </form>
</main>
<iframe name="hidden_iframe" style="display:none;"></iframe>

<footer>
  <div class="footer-content">
    <div class="footer-section"><h4>Quick Links</h4><ul><li><a href="#">Attendance Policy</a></li></ul></div>
    <div class="footer-section"><h4>Social Media</h4><ul><li><a href="https://www.youtube.com/@nischaybahl7714" target="_blank">YouTube</a></li></ul></div>
    <div class="footer-section"><h4>Contact</h4><ul><li><a href="mailto:bca25.28.dav@gmail.com">bca25.28.dav@gmail.com</a></li></ul></div>
    <div class="footer-section"><h4>Address</h4><ul><li>D.A.V. College, Mahatma Hansraj Marg,<br>Jalandhar, Punjab – 144008, India</li></ul></div>
  </div>
  <div class="footer-divider"></div>
  <div class="footer-bottom">© 2025 | Credits: Prabhsimranjot Singh, BCA (FCA-1)</div>
</footer>

<script>
  const rollToName = {
    "1": "CHIRAG RANA", "2": "SHARANJIT SINGH", "3": "ANEESH KUMAR", "4": "JATINVEER", "5": "SOHAN KUMAR", "6": "TUSHAR", "7": "VANSH SHARMA",
    "8": "SAGAR KUMAR MANDAL", "9": "MEHAK", "10": "MANREET KAUR", "11": "ARUSHI", "12": "MANNAT", "13": "SURAJ SINGH", "14": "DIPANKAR",
    "15": "SNEHA", "16": "NAVJOT KAUR", "17": "ADITYA SHARMA", "18": "ROHAN", "19": "DAMANJEET", "20": "SHIVAM PANDEY", "21": "NITIN", "22": "NIKHIL",
    "23": "AARUSHI MALHOTRA", "24": "ANKIT KUMAR", "25": "EKAMJEET KAUR KALRA", "26": "SHIVAM", "27": "PRABHSIMRANJOT SINGH", "28": "SUMANT SHARMA",
    "29": "HARSHIT", "30": "NAMPREET SINGH", "31": "TANUSH", "32": "PARTH AULUCK", "33": "TANISH JAIN", "34": "PALAK BHARDWAJ", "35": "AKASH DEEP",
    "36": "AYUSH KUMAR", "37": "LAKSH", "38": "JASHAN ARORA", "39": "KRISHAN SINGH", "40": "KULWINDER KAUR", "41": "DAKSH CHAUHAN", "42": "DIWAKAR",
    "43": "SARUCHI SHARMA", "44": "AMRITPAL SINGH", "45": "GLORY", "46": "SIMRAN", "47": "MANIK", "48": "OM TALWAR", "49": "NITIN KUMARN BASRA",
    "50": "KHUSHI", "51": "KUNAL BHAGAT", "52": "JATIN GILHOTRA", "53": "LAKSH KALIA", "54": "LAKSHAY JOSHI", "55": "MAANSHU DUBEY", "56": "PREET LOI",
    "57": "KARAN SINGH", "58": "VIBHOR JAIN", "59": "UTKARSHA RAJ SINGH", "60": "MEHAK", "61": "NIKHIL"
  };

  const codeSchedule = {
    "2025-07-27": "ABC",
    "2025-07-28": "XYZ",
    "2025-07-29": "PQR"
  };

  let todayCode = "";

  function disableFields(disabled) {
    document.getElementById('roll').disabled = disabled;
    document.getElementById('name').disabled = disabled;
    document.getElementById('confirm').disabled = disabled;
    document.querySelector('button[type="submit"]').disabled = disabled;
  }

  window.onload = function () {
    setTimeout(() => {
      document.getElementById('preloader').classList.add('fade-out');
      document.getElementById('main-content').classList.add('visible');
    }, 1500);

    const rollDropdown = document.getElementById('roll');
    Object.keys(rollToName).sort((a, b) => a - b).forEach(roll => {
      const option = document.createElement('option');
      option.value = roll;
      option.textContent = roll;
      rollDropdown.appendChild(option);
    });

    rollDropdown.addEventListener('change', e => {
      document.getElementById('name').value = rollToName[e.target.value] || '';
    });

    const today = new Date().toISOString().split("T")[0];
    todayCode = codeSchedule[today] || "";
    disableFields(true);

    document.getElementById('code').addEventListener('input', function () {
      const inputCode = this.value.trim().toUpperCase();
      if (inputCode === todayCode) {
        document.getElementById('codeError').classList.add('hidden');
        disableFields(false);
      } else {
        disableFields(true);
        document.getElementById('codeError').classList.remove('hidden');
      }
    });

    document.getElementById('attendanceForm').addEventListener('submit', function (e) {
      const now = new Date();
      const ISTTime = new Date(now.toLocaleString("en-US", { timeZone: "Asia/Kolkata" }));
      const hour = ISTTime.getHours();
      const minute = ISTTime.getMinutes();
      if (!(hour === 12 && minute >= 40 || hour === 14 && minute <= 15)) {
        alert("Form accessible only between 1:30 PM and 2:15 PM IST");
        e.preventDefault();
        return;
      }

      const codeInput = document.getElementById('code').value.trim().toUpperCase();
      if (codeInput !== todayCode) {
        document.getElementById('codeError').classList.remove('hidden');
        e.preventDefault();
        return;
      }

      const confirmed = confirm("Attendance submitted successfully. Click OK to proceed to the feedback form.");
      if (confirmed) {
        window.location.href = "https://example.com/feedback"; // <- Replace with actual feedback form
      }

      setTimeout(() => {
        document.getElementById('attendanceForm').reset();
        document.getElementById('name').value = "";
        disableFields(true);
      }, 500);
    });
  };
</script>
</body>
</html>
